ltm rule rule_cve-2022-26134 {
when HTTP_REQUEST {
   # Lower risk for successful exploitation of CVE-2022-26134
   #
   # As stated by Atlassian:
   # https://confluence.atlassian.com/doc/confluence-security-advisory-2022-06-02-1130377146.html
   set pattern "*\$\{*";
   set uri "[URI::decode [HTTP::uri]]";
   if { [string match $pattern $uri] } {
      log local0. "CVE-2022-26134 - Detected possible CVE-2022-26134 attack from '[IP::client_addr]' in URI '[HTTP::uri]' - blocking request";
      log local0. "CVE-2022-26134 - The decoded version of \"[HTTP::uri]\" is \"[URI::decode [HTTP::uri]]\""
      reject;
   }
}
}
